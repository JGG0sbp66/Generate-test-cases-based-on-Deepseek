import json
from json_repair import repair_json
from model import function
from model.function import write_excel

output_path = r'./test_report/测试用例.xlsx'

target = """
[{'模块名称': '商品信息—商品分类', '功能项': '新增商品分类', '用例说明': '验证新增商品分类功能', '前置条件': '系统已打开商品信息管理页面', '输入': '商品分类名称：1字符或17字符', '执行步骤': '点击【新增】按钮，输入无效的字符数量（1或17）后回车', '预期结果': "显示'商品分类名称 必填，请重新输入。'提示信息"}, {'模块名称': '商品信息—商品分类', '功能项': '查询商品分类', '用例说明': '验证查询商品分类功能', '前置条件': '系统已打开商品信息管理页面', '输入': '商品分类名称为空', '执行步骤': '点击【查询】按钮，输入字段为空', '预期结果': "显示'请输入商品分类名称查询'提示信息"}, {'模块名称': '商品信息—商品分类', '功能项': '修改商品分类', '用例说明': '验证修改商品分类功能', '前置条件': '系统已打开商品信息管理页面，已有商品分类存在', '输入': '商品分类名称为空', '执行步骤': '点击【修改】按钮，输入字段为空', '预期结果': "显示 '商品分类名称 必填，请重新输入。'提示信息"}, {'模块名称': '商品信息—商品分类', '功能项': '启用商品分类', '用例说明': '验证启用商品分类功能', '前置条件': '系统已打开商品信息管理页面，已有商品分类存在', '输入': '选择已存在的商品分类进行启用操作', '执行步骤': '点击【启用】按钮，选择一个已存在的商品分类', '预期结果': "被选中的商品分类状态变为'启用'，显示在列表中"}, {'模块名称': '商品信息—商品分类', '功能项': '禁用商品分类', '用例说明': '验证禁用商品分类功能', '前置条件': '系统已打开商品信息管理页面，已有商品分类存在', '输入': '选择一个已存在的商品分类进行禁用操作', '执行步骤': '点击【禁用】按钮，选择一个已存在的商品分类', '预期结果': "被选中的商品分类状态变为'禁用'，显示在列表中"}, {'模块名称': '商品信息—商品分类', '功能项': '查询商品分类（按状态）', '用例说明': '验证按状态查询商品分类功能', '前置条件': '系统已打开商品信息管理页面', '输入': "选择'启用'状态进行查询", '执行步骤': "点击【查询】按钮，下拉框选择'启用'", '预期结果': '显示所有启用的状态商品分类'}, {'模块名称': '商品信息—商品分类', '功能项': '查询商品分类（按状态）', '用例说明': '验证按禁用状态查询商品分类功能', '前置条件': '系统已打开商品信息管理页面', '输入': "选择'禁用'状态进行查询", '执行步骤': "点击【查询】按钮，下拉框选择'禁用'", '预期结果': '显示所有禁用的状态商品分类'}, {'模块名称': '商品信息—商品分类', '功能项': '新增商品分类', '用例说明': '测试新增商品分类功能', '前置条件': '系统打开商品分类页面', '输入': '商品分类名称：计算机', '执行步骤': '点击【新增】，输入商品分类名称并保存', '预期结果': '成功新增商品分类'}, {'模块名称': '商品信息—商品分类', '功能项': '修改商品分类', '用例说明': '测试商品分类修改功能', '前置条件': '系统打开商品分类列表页', '输入': '选择要修改的商品分类，输入新名称：软件工程', '执行步骤': '点击【修改】，输入新名称并保存', '预期结果': '成功修改商品分类'}, {'模块名称': '商品信息—商品分类', '功能项': '列表页', '用例说明': '正确显示所有商品分类并导航', '前置条件': '系统管理员权限', '输入': '', '执行步骤': '在商品分类列表页点击左侧菜单栏中的“基础信息管理—商品信息—商品分类”菜单项', '预期结果': '默认显示所有商品分类信息，按创建时间降序排列'}, {'模块名称': '商品信息—商品分类', '功能项': '新增', '用例说明': '正确新增商品分类', '前置条件': '系统管理员权限', '输入': '商品分类名称：必填项，与系统内的商品分类名称不能重复且长度符合要求', '执行步骤': '在商品分类新增窗口输入商品分类名称并点击“保存”按钮', '预期结果': '成功添加新商品分类，状态为启用'}, {'模块名称': '商品信息—商品分类', '功能项': '修改', '用例说明': '正确修改商品分类信息', '前置条件': '系统管理员权限且已有商品分类存在', '输入': '商品分类名称：必填项，与现有值不完全相同且符合规则', '执行步骤': '在商品分类修改窗口输入新的商品分类名称并点击“保存”按钮', '预期结果': '成功更新商品分类信息'}, {'模块名称': '商品信息—商品分类', '功能项': '启用', '用例说明': '正确启用或禁用商品分类', '前置条件': '系统管理员权限', '输入': '商品分类状态：启用/禁用', '执行步骤': '在商品分类启用窗口点击“启用”或“禁用”按钮后，检查状态变化', '预期结果': '状态正确切换为启用或禁用'}, {'模块名称': '商品信息—商品分类', '功能项': '查询', '用例说明': '正确过滤并显示符合条件的商品分类列表', '前置条件': '系统管理员权限且已有商品分类存在', '输入': '商品分类名称或状态：必填项，不能为空', '执行步骤': '在商品分类查询窗口输入过滤条件后点击“查询”按钮', '预期结果': '显示符合条件的商品分类列表，并保留查询条件'}, {'模块名称': '商品信息—商品分类', '功能项': '查询', '用例说明': '正确清除查询条件', '前置条件': '系统管理员权限且已有商品分类存在且有查询条件', '输入': '', '执行步骤': '在商品分类查询窗口点击“重置”按钮以清空查询条件', '预期结果': '查询条件被清空，显示所有商品分类信息'}, {'模块名称': '商品信息—新增商品分类', '功能项': '新增', '用例说明': '验证新增商品分类窗口的输入处理', '前置条件': '打开系统并进入基础信息管理界面', '输入': "商品分类名称：'手机'", '执行步骤': '点击【新增】按钮，弹出新增窗口', '预期结果': '窗口显示输入字段，并提示字符长度限制'}, {'模块名称': '商品信息—新增商品分类', '功能项': '新增', '用例说明': '验证重复输入的处理', '前置条件': '打开系统并进入基础信息管理界面', '输入': "商品分类名称：'手机'", '执行步骤': '再次输入相同的商品分类名称', '预期结果': '提示输入项不能与现有商品分类名称重复'}, {'模块名称': '商品信息—新增商品分类', '功能项': '新增', '用例说明': '验证无效输入的处理', '前置条件': '打开系统并进入基础信息管理界面', '输入': "商品分类名称：'无效字符'（包含特殊符号）", '执行步骤': '点击【新增】按钮，弹出新增窗口', '预期结果': '提示输入项不符合要求'}, {'模块名称': '商品信息—修改商品分类', '功能项': '修改', '用例说明': '验证修改窗口的输入处理', '前置条件': '找到要修改的商品分类记录', '输入': "商品分类名称：'手机'", '执行步骤': '点击【修改】按钮，弹出修改窗口', '预期结果': '显示当前商品分类信息并提示字符长度限制'}, {'模块名称': '商品信息—修改商品分类', '功能项': '修改', '用例说明': '验证重复输入的处理', '前置条件': '找到要修改的商品分类记录，并输入相同的名称', '输入': "商品分类名称：'手机'", '执行步骤': '再次输入相同的商品分类名称', '预期结果': '提示输入项不能与现有商品分类名称重复'}, {'模块名称': '商品信息—修改商品分类', '功能项': '修改', '用例说明': '验证无效输入的处理', '前置条件': '找到要修改的商品分类记录，并输入无效字符', '输入': "商品分类名称：'无效字符'（包含特殊符号）", '执行步骤': '点击【修改】按钮，弹出修改窗口', '预期结果': '提示输入项不符合要求'}, {'模块名称': '商品信息—启用商品分类', '功能项': '启用', '用例说明': '验证启用操作后的状态变化', '前置条件': '找到要启用的商品分类记录', '输入': '点击【启用】按钮', '执行步骤': '点击【启用】按钮后，系统状态变为启用', '预期结果': '记录状态从禁用变为启用'}, {'模块名称': '商品信息—禁用商品分类', '功能项': '禁用', '用例说明': '验证禁用操作后的状态变化', '前置条件': '找到要禁用的商品分类记录', '输入': '点击【禁用】按钮', '执行步骤': '点击【禁用】按钮后，系统状态变为禁用', '预期结果': '记录状态从启用变为禁用'}, {'模块名称': '商品信息—查询商品分类信息', '功能项': '查询', '用例说明': '验证查询操作后的结果展示', '前置条件': '打开系统并进入基础信息管理界面', '输入': "商品分类名称：'手机'", '执行步骤': '点击【查询】按钮', '预期结果': '显示符合条件的商品分类信息，并保留查询条件'}, {'模块名称': '商品信息—查询商品分类信息', '功能项': '查询', '用例说明': '验证模糊查询的功能', '前置条件': '打开系统并进入基础信息管理界面', '输入': "商品分类名称：'手机'", '执行步骤': '输入不相关的关键词进行模糊查询', '预期结果': '显示不符合条件的商品分类信息'}, {'模块名称': '商品信息—查询商品分类信息', '功能项': '查询', '用例说明': '验证状态查询的功能', '前置条件': '打开系统并进入基础信息管理界面', '输入': '下拉框选择禁用状态', '执行步骤': '点击【查询】按钮', '预期结果': '显示符合条件的商品分类信息，并保留查询条件'}, {'模块名称': '商品信息—查询商品分类信息', '功能项': '查询', '用例说明': '验证重置查询条件的功能', '前置条件': '打开系统并进入基础信息管理界面', '输入': '任意查询条件', '执行步骤': '点击【重置】按钮', '预期结果': '清空所有查询条件'}, {'模块名称': '商品信息—商品分类', '功能项': '正确执行新增商品分类操作', '用例说明': '验证新增商品分类窗口的输入处理', '前置条件': '系统已打开商品分类管理界面', '输入': '商品分类名称：test_category', '执行步骤': '点击【新增】按钮，弹出“新增商品分类”窗口；输入“test_category”作为商品分类名称；点击【保存】按钮', '预期结果': '成功创建新商品分类，显示在列表页上'}, {'模块名称': '商品信息—商品分类', '功能项': '正确执行修改商品分类操作', '用例说明': '验证正确修改商品分类信息', '前置条件': '已有商品分类存在于列表中', '输入': '商品分类名称：new_category', '执行步骤': '点击【修改】按钮，弹出“修改商品分类”窗口；输入“new_category”作为商品分类名称；点击【保存】按钮', '预期结果': '成功更新商品分类信息，显示在列表页上'}, {'模块名称': '商品信息—商品分类', '功能项': '正确执行商品分类的启用操作', '用例说明': '验证商品分类启用操作的正确性', '前置条件': '商品分类处于禁用状态', '输入': '点击【启用】按钮', '执行步骤': '点击【启用】按钮，弹出二次确认窗口；点击【确定】按钮', '预期结果': '成功将商品分类状态由禁用改为启用'}, {'模块名称': '商品信息—商品分类', '功能项': '正确执行商品分类的禁用操作', '用例说明': '验证商品分类禁用操作的正确性', '前置条件': '商品分类处于启用状态', '输入': '点击【禁用】按钮', '执行步骤': '点击【禁用】按钮，弹出二次'}]
"""

good_json = repair_json(target)

write_excel(json.loads(good_json), output_path)
